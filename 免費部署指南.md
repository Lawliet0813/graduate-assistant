# ğŸš€ ç ”ç©¶ç”Ÿæ™ºèƒ½åŠ©ç†ç³»çµ± - å…è²»éƒ¨ç½²æŒ‡å—

> å®Œå…¨å…è²»çš„é›²ç«¯éƒ¨ç½²æ–¹æ¡ˆï¼ˆæ¯æœˆ $0ï¼‰

## ğŸ“Š ç³»çµ±æ¶æ§‹åˆ†æ

### éœ€è¦éƒ¨ç½²çš„çµ„ä»¶

1. **Next.js æ‡‰ç”¨**ï¼ˆå‰ç«¯ + APIï¼‰
2. **PostgreSQL è³‡æ–™åº«**
3. **Python Moodle æœå‹™**ï¼ˆSelenium + Chromeï¼‰
4. **æª”æ¡ˆå„²å­˜**ï¼ˆéŒ„éŸ³æª”ã€ç­†è¨˜ç­‰ï¼‰

---

## ğŸ’° æœ€ä½³å…è²»éƒ¨ç½²æ–¹æ¡ˆ

### æ–¹æ¡ˆ Aï¼šVercel + Supabase + Renderï¼ˆæ¨è–¦ï¼‰â­

**æœ€ç°¡å–®ã€æœ€ç©©å®šçš„å…è²»æ–¹æ¡ˆ**

| çµ„ä»¶ | å¹³å° | å…è²»é¡åº¦ | é™åˆ¶ |
|------|------|---------|------|
| Next.js æ‡‰ç”¨ | **Vercel** | å…è²» | 100GB é »å¯¬/æœˆ |
| PostgreSQL | **Supabase** | 500MB å…è²» | 2 å€‹å°ˆæ¡ˆ |
| Python Moodle | **Render** | 750 å°æ™‚/æœˆ | åœæ©Ÿå¾Œéœ€é‡å•Ÿ |
| æª”æ¡ˆå„²å­˜ | **Supabase Storage** | 1GB å…è²» | - |

**ç¸½æˆæœ¬ï¼š$0/æœˆ**

---

### æ–¹æ¡ˆ Bï¼šRailwayï¼ˆå…¨åˆä¸€æ–¹æ¡ˆï¼‰

**æ‰€æœ‰æœå‹™åœ¨åŒä¸€å¹³å°**

| çµ„ä»¶ | è²»ç”¨ | å…è²»é¡åº¦ |
|------|------|---------|
| Next.js + PostgreSQL + Python | **Railway** | $5 å…è²»é¡åº¦/æœˆ |

**å„ªé»ï¼š** è¨­å®šç°¡å–®ã€çµ±ä¸€ç®¡ç†
**ç¼ºé»ï¼š** å…è²»é¡åº¦æœ‰é™ï¼ˆ$5/æœˆï¼‰ï¼Œå¯èƒ½ä¸å¤ ç”¨

---

## ğŸ¯ æ¨è–¦æ–¹æ¡ˆ A è©³ç´°æ­¥é©Ÿ

### ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½² PostgreSQL è³‡æ–™åº«ï¼ˆSupabaseï¼‰

#### 1. å»ºç«‹ Supabase å°ˆæ¡ˆ

```bash
# 1. å‰å¾€ https://supabase.com
# 2. é»æ“Šã€ŒStart your projectã€
# 3. ä½¿ç”¨ GitHub ç™»å…¥
# 4. å»ºç«‹æ–°çµ„ç¹”å’Œå°ˆæ¡ˆ
```

#### 2. ç²å–è³‡æ–™åº«é€£ç·šè³‡è¨Š

```bash
# åœ¨ Supabase Dashboard:
# Settings â†’ Database â†’ Connection String

# è¤‡è£½ Connection String (Pooling)
postgresql://postgres.[PROJECT-REF]:[YOUR-PASSWORD]@aws-0-ap-northeast-1.pooler.supabase.com:5432/postgres
```

#### 3. æ›´æ–° `.env`

```bash
# å‰µå»º .env.production
DATABASE_URL="postgresql://postgres.[PROJECT-REF]:[PASSWORD]@aws-0-ap-northeast-1.pooler.supabase.com:5432/postgres?pgbouncer=true"
DIRECT_URL="postgresql://postgres.[PROJECT-REF]:[PASSWORD]@aws-0-ap-northeast-1.pooler.supabase.com:5432/postgres"
```

---

### ç¬¬äºŒæ­¥ï¼šéƒ¨ç½² Next.js æ‡‰ç”¨ï¼ˆVercelï¼‰

#### 1. æº–å‚™å°ˆæ¡ˆ

```bash
# ç¢ºä¿æœ‰ vercel.json
cat > vercel.json << 'EOF'
{
  "buildCommand": "npm run build",
  "devCommand": "npm run dev",
  "installCommand": "npm install",
  "framework": "nextjs",
  "regions": ["hkg1"],
  "env": {
    "DATABASE_URL": "@database_url",
    "NEXTAUTH_SECRET": "@nextauth_secret",
    "NEXTAUTH_URL": "@nextauth_url"
  }
}
EOF
```

#### 2. éƒ¨ç½²åˆ° Vercel

```bash
# æ–¹æ³• 1: ä½¿ç”¨ Vercel CLI
npm i -g vercel
vercel login
vercel

# æ–¹æ³• 2: ä½¿ç”¨ GitHub æ•´åˆï¼ˆæ¨è–¦ï¼‰
# 1. å‰å¾€ https://vercel.com
# 2. é»æ“Šã€ŒImport Projectã€
# 3. é€£æ¥ GitHub repository
# 4. é¸æ“‡ graduate-assistant
# 5. é…ç½®ç’°å¢ƒè®Šæ•¸
```

#### 3. è¨­å®šç’°å¢ƒè®Šæ•¸

åœ¨ Vercel Dashboard â†’ Settings â†’ Environment Variables æ·»åŠ ï¼š

```bash
# è³‡æ–™åº«
DATABASE_URL=postgresql://... (from Supabase)
DIRECT_URL=postgresql://... (from Supabase)

# NextAuth
NEXTAUTH_SECRET=run: openssl rand -base64 32
NEXTAUTH_URL=https://your-app.vercel.app

# Google OAuth
GOOGLE_CLIENT_ID=...
GOOGLE_CLIENT_SECRET=...

# API Keys
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
NOTION_API_KEY=secret_...

# Moodle Service
MOODLE_SERVICE_URL=https://your-moodle-service.onrender.com
MOODLE_SERVICE_API_KEY=...
```

#### 4. åŸ·è¡Œè³‡æ–™åº«é·ç§»

```bash
# æœ¬åœ°åŸ·è¡Œ
npm run db:push

# æˆ–åœ¨ Vercel å°ˆæ¡ˆè¨­å®šä¸­æ·»åŠ å»ºç½®å‘½ä»¤
# Build Command: prisma generate && prisma db push && next build
```

---

### ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½² Python Moodle æœå‹™ï¼ˆRenderï¼‰

#### 1. æº–å‚™ Dockerfile

```dockerfile
# å»ºç«‹ services/moodle-service/Dockerfile
FROM python:3.12-slim

# å®‰è£ Chrome å’Œä¾è³´
RUN apt-get update && apt-get install -y \
    wget \
    gnupg \
    unzip \
    curl \
    && wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add - \
    && echo "deb http://dl.google.com/linux/chrome/deb/ stable main" >> /etc/apt/sources.list.d/google-chrome.list \
    && apt-get update \
    && apt-get install -y google-chrome-stable \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# å®‰è£ Python ä¾è³´
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# è¤‡è£½æ‡‰ç”¨ç¨‹å¼
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 8000

# å•Ÿå‹•å‘½ä»¤
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
```

#### 2. å»ºç«‹ render.yaml

```yaml
# å»ºç«‹ services/moodle-service/render.yaml
services:
  - type: web
    name: moodle-service
    env: docker
    region: singapore
    plan: free
    dockerfilePath: ./Dockerfile
    envVars:
      - key: PORT
        value: 8000
      - key: API_KEY
        generateValue: true
      - key: ALLOWED_ORIGINS
        value: https://your-app.vercel.app
      - key: MOODLE_BASE_URL
        value: https://moodle45.nccu.edu.tw
```

#### 3. éƒ¨ç½²åˆ° Render

```bash
# æ–¹æ³• 1: ä½¿ç”¨ Render Blueprintï¼ˆæ¨è–¦ï¼‰
# 1. å‰å¾€ https://render.com
# 2. é€£æ¥ GitHub
# 3. é¸æ“‡ New â†’ Blueprint
# 4. é¸æ“‡ services/moodle-service/render.yaml

# æ–¹æ³• 2: æ‰‹å‹•éƒ¨ç½²
# 1. New â†’ Web Service
# 2. é€£æ¥ GitHub repository
# 3. Root Directory: services/moodle-service
# 4. Environment: Docker
# 5. æ·»åŠ ç’°å¢ƒè®Šæ•¸
```

#### 4. é‡è¦è¨­å®š

âš ï¸ **Render å…è²»æ–¹æ¡ˆé™åˆ¶ï¼š**
- æœå‹™é–’ç½® 15 åˆ†é˜å¾Œæœƒè‡ªå‹•åœæ­¢
- ä¸‹æ¬¡è«‹æ±‚æ™‚éœ€è¦ 30-60 ç§’å†·å•Ÿå‹•
- æ¯æœˆ 750 å°æ™‚å…è²»ï¼ˆè¶³å¤ å–®å€‹æœå‹™å…¨æœˆé‹è¡Œï¼‰

**è§£æ±ºæ–¹æ¡ˆï¼š**
```bash
# åœ¨ Vercel çš„ API route æ·»åŠ é‡è©¦é‚è¼¯
# src/server/api/routers/moodle.ts

async function callMoodleService(endpoint: string, options?: RequestInit) {
  let retries = 3;
  while (retries > 0) {
    try {
      const response = await fetch(
        `${process.env.MOODLE_SERVICE_URL}${endpoint}`,
        {
          ...options,
          headers: {
            'X-API-Key': process.env.MOODLE_SERVICE_API_KEY!,
            ...options?.headers,
          },
        }
      );
      return response;
    } catch (error) {
      retries--;
      if (retries === 0) throw error;
      // ç­‰å¾…å†·å•Ÿå‹•
      await new Promise(resolve => setTimeout(resolve, 30000));
    }
  }
}
```

---

### ç¬¬å››æ­¥ï¼šè¨­å®šæª”æ¡ˆå„²å­˜ï¼ˆSupabase Storageï¼‰

#### 1. å»ºç«‹ Storage Bucket

```bash
# åœ¨ Supabase Dashboard:
# Storage â†’ Create bucket

# Bucket è¨­å®š:
Name: voice-notes
Public: false (ç§æœ‰)
File size limit: 50MB
Allowed MIME types: audio/*, application/json
```

#### 2. è¨­å®šå­˜å–æ”¿ç­–

```sql
-- åœ¨ Supabase SQL Editor åŸ·è¡Œ:

-- å…è¨±å·²èªè­‰ä½¿ç”¨è€…ä¸Šå‚³
CREATE POLICY "Allow authenticated uploads"
ON storage.objects
FOR INSERT
TO authenticated
WITH CHECK (bucket_id = 'voice-notes');

-- å…è¨±å·²èªè­‰ä½¿ç”¨è€…è®€å–è‡ªå·±çš„æª”æ¡ˆ
CREATE POLICY "Allow authenticated reads"
ON storage.objects
FOR SELECT
TO authenticated
USING (bucket_id = 'voice-notes' AND auth.uid()::text = (storage.foldername(name))[1]);
```

#### 3. æ›´æ–°æ‡‰ç”¨ç¨‹å¼ç¢¼

```typescript
// src/lib/storage.ts
import { createClient } from '@supabase/supabase-js'

const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL!,
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
)

export async function uploadVoiceNote(file: File, userId: string) {
  const filePath = `${userId}/${Date.now()}_${file.name}`

  const { data, error } = await supabase.storage
    .from('voice-notes')
    .upload(filePath, file)

  if (error) throw error
  return data
}
```

---

## âš™ï¸ å®Œæ•´ç’°å¢ƒè®Šæ•¸æ¸…å–®

### Vercel (Next.js)

```bash
# è³‡æ–™åº«
DATABASE_URL=postgresql://...
DIRECT_URL=postgresql://...

# Auth
NEXTAUTH_SECRET=...
NEXTAUTH_URL=https://your-app.vercel.app

# Google
GOOGLE_CLIENT_ID=...
GOOGLE_CLIENT_SECRET=...

# API Keys
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
NOTION_API_KEY=secret_...

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJ...

# Moodle Service
MOODLE_SERVICE_URL=https://moodle-service.onrender.com
MOODLE_SERVICE_API_KEY=...
```

### Render (Moodle Service)

```bash
PORT=8000
API_KEY=... (è‡ªå‹•ç”Ÿæˆ)
ALLOWED_ORIGINS=https://your-app.vercel.app
MOODLE_BASE_URL=https://moodle45.nccu.edu.tw
```

---

## ğŸ”§ éƒ¨ç½²å¾Œè¨­å®š

### 1. è¨­å®š Google OAuth

```bash
# Google Cloud Console
# https://console.cloud.google.com

# Authorized JavaScript origins:
https://your-app.vercel.app

# Authorized redirect URIs:
https://your-app.vercel.app/api/auth/callback/google
```

### 2. è¨­å®š Notion Integration

```bash
# Notion Developers
# https://www.notion.so/my-integrations

# Integration Name: Graduate Assistant
# Associated workspace: Your workspace
# Capabilities: Read content, Update content, Insert content
```

### 3. å•Ÿç”¨ Google APIs

```bash
# Google Cloud Console â†’ APIs & Services

# å•Ÿç”¨ä»¥ä¸‹ APIs:
- Google Calendar API
- Gmail API
- Google Drive API
```

---

## ğŸ“Š æˆæœ¬é ä¼°

| æœå‹™ | å…è²»é¡åº¦ | è¶…å‡ºæˆæœ¬ | é ä¼°ä½¿ç”¨ |
|------|---------|---------|---------|
| **Vercel** | 100GB é »å¯¬/æœˆ | $20/100GB | ~5GB/æœˆ âœ… |
| **Supabase** | 500MB DB + 1GB Storage | $25/æœˆ | ~200MB âœ… |
| **Render** | 750 å°æ™‚/æœˆ | $7/æœˆ | 720 å°æ™‚ âœ… |
| **OpenAI** | $5 å…è²»é¡åº¦ï¼ˆæ–°ç”¨æˆ¶ï¼‰ | æŒ‰ç”¨é‡ | ~$2/æœˆ |
| **Anthropic** | - | æŒ‰ç”¨é‡ | ~$3/æœˆ |

**ç¸½æˆæœ¬é ä¼°ï¼š**
- **å‰ 3 å€‹æœˆï¼š** $0/æœˆï¼ˆä½¿ç”¨å…è²»é¡åº¦ï¼‰
- **ä¹‹å¾Œï¼š** ~$5/æœˆï¼ˆåƒ… API èª¿ç”¨è²»ç”¨ï¼‰

---

## ğŸš¨ æ³¨æ„äº‹é …

### Render å…è²»æ–¹æ¡ˆé™åˆ¶

âš ï¸ **å†·å•Ÿå‹•å•é¡Œï¼š**
- æœå‹™é–’ç½® 15 åˆ†é˜å¾Œæœƒåœæ­¢
- ä¸‹æ¬¡è«‹æ±‚éœ€è¦ 30-60 ç§’å•Ÿå‹•

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. åœ¨å‰ç«¯æ·»åŠ è¼‰å…¥æç¤º
2. å¯¦ä½œé‡è©¦é‚è¼¯
3. æˆ–å‡ç´šåˆ° Render ä»˜è²»æ–¹æ¡ˆï¼ˆ$7/æœˆï¼Œç„¡å†·å•Ÿå‹•ï¼‰

### Vercel å‡½æ•¸åŸ·è¡Œæ™‚é–“

âš ï¸ **å…è²»æ–¹æ¡ˆé™åˆ¶ï¼š**
- æœ€é•·åŸ·è¡Œæ™‚é–“ï¼š10 ç§’
- Moodle åŒæ­¥å¯èƒ½éœ€è¦ 1-3 åˆ†é˜

**è§£æ±ºæ–¹æ¡ˆï¼š**
- å°‡åŒæ­¥é‚è¼¯ç§»åˆ° Render çš„ Python æœå‹™
- Vercel åªèª¿ç”¨ APIï¼Œä¸ç›´æ¥åŸ·è¡ŒåŒæ­¥

### Supabase è³‡æ–™åº«å¤§å°

âš ï¸ **å…è²»æ–¹æ¡ˆé™åˆ¶ï¼š**
- 500MB è³‡æ–™åº«
- 1GB æª”æ¡ˆå„²å­˜

**è§£æ±ºæ–¹æ¡ˆï¼š**
- å®šæœŸæ¸…ç†èˆŠè³‡æ–™
- å¤§æª”æ¡ˆä½¿ç”¨å¤–éƒ¨å„²å­˜ï¼ˆGoogle Driveï¼‰
- æˆ–å‡ç´šåˆ° Pro æ–¹æ¡ˆï¼ˆ$25/æœˆï¼Œ8GB DBï¼‰

---

## ğŸ”„ CI/CD è‡ªå‹•éƒ¨ç½²

### GitHub Actions

```yaml
# .github/workflows/deploy.yml
name: Deploy

on:
  push:
    branches: [main]

jobs:
  deploy-vercel:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 20
      - run: npm ci
      - run: npm run build
      - uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.ORG_ID }}
          vercel-project-id: ${{ secrets.PROJECT_ID }}
          vercel-args: '--prod'
```

---

## ğŸ“ˆ ç›£æ§å’Œç¶­è­·

### 1. Vercel Analyticsï¼ˆå…è²»ï¼‰

```bash
# åœ¨ Vercel Dashboard å•Ÿç”¨
# Analytics â†’ Enable

# è‡ªå‹•è¿½è¹¤:
- é é¢è¨ªå•é‡
- æ•ˆèƒ½æŒ‡æ¨™
- Web Vitals
```

### 2. Supabase ç›£æ§

```bash
# Dashboard â†’ Database â†’ Database Health

# ç›£æ§:
- è³‡æ–™åº«å¤§å°
- é€£æ¥æ•¸
- æŸ¥è©¢æ•ˆèƒ½
```

### 3. Render æ—¥èªŒ

```bash
# Service â†’ Logs

# å³æ™‚æŸ¥çœ‹:
- æ‡‰ç”¨ç¨‹å¼æ—¥èªŒ
- éŒ¯èª¤è¨Šæ¯
- HTTP è«‹æ±‚
```

---

## ğŸ“ æ›¿ä»£æ–¹æ¡ˆæ¯”è¼ƒ

| æ–¹æ¡ˆ | å„ªé» | ç¼ºé» | æˆæœ¬ |
|------|------|------|------|
| **Vercel + Supabase + Render** | ç©©å®šã€ç°¡å–® | éœ€è¦ç®¡ç†å¤šå€‹å¹³å° | $0-5/æœˆ |
| **Railway** | çµ±ä¸€å¹³å°ã€æ˜“ç®¡ç† | å…è²»é¡åº¦æœ‰é™ | $0-10/æœˆ |
| **Fly.io** | å¼·å¤§ã€å½ˆæ€§é«˜ | è¨­å®šè¤‡é›œ | $0-5/æœˆ |
| **è‡ªæ¶ VPS** | å®Œå…¨æ§åˆ¶ | éœ€è¦ç¶­è­· | $5-10/æœˆ |
| **Heroku** | ç°¡å–® | å…è²»æ–¹æ¡ˆå·²å–æ¶ˆ | $7/æœˆèµ· |

---

## âœ… ç¸½çµ

### æ¨è–¦é…ç½®ï¼ˆå®Œå…¨å…è²»ï¼‰

```
Next.js æ‡‰ç”¨    â†’ Vercel (å…è²»)
PostgreSQL     â†’ Supabase (å…è²» 500MB)
Python Service â†’ Render (å…è²» 750 å°æ™‚/æœˆ)
æª”æ¡ˆå„²å­˜       â†’ Supabase Storage (å…è²» 1GB)
ç›£æ§          â†’ Vercel Analytics (å…è²»)
```

### å‡ç´šè·¯å¾‘ï¼ˆå¦‚éœ€æ“´å±•ï¼‰

**ç¬¬ä¸€éšæ®µæ“´å±•ï¼ˆ~$10/æœˆï¼‰:**
- Render Starter: $7/æœˆï¼ˆç„¡å†·å•Ÿå‹•ï¼‰
- ä¿æŒå…¶ä»–æœå‹™å…è²»

**ç¬¬äºŒéšæ®µæ“´å±•ï¼ˆ~$35/æœˆï¼‰:**
- Vercel Pro: $20/æœˆ
- Supabase Pro: $25/æœˆ
- Render Starter: $7/æœˆ

---

## ğŸ”— ç›¸é—œè³‡æº

- [Vercel éƒ¨ç½²æ–‡æª”](https://vercel.com/docs)
- [Supabase æ–‡æª”](https://supabase.com/docs)
- [Render éƒ¨ç½²æŒ‡å—](https://render.com/docs)
- [Next.js éƒ¨ç½²æœ€ä½³å¯¦è¸](https://nextjs.org/docs/deployment)

---

**å»ºç«‹æ™‚é–“**: 2025-11-23
**æœ€å¾Œæ›´æ–°**: 2025-11-23
**æ¸¬è©¦ç‹€æ…‹**: âœ… å·²é©—è­‰å…è²»éƒ¨ç½²å¯è¡Œ
